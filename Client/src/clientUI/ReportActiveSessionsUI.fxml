<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>

<AnchorPane styleClass="main-pane"
	stylesheets="@ReportScreen.css, @styles.css"
	xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
	fx:controller="clientControllers.ReportActiveSessionsController">

	<VBox alignment="CENTER" spacing="20.0" style="-fx-padding: 20;"
		styleClass="menu-container" AnchorPane.bottomAnchor="20.0"
		AnchorPane.leftAnchor="20.0" AnchorPane.rightAnchor="20.0"
		AnchorPane.topAnchor="20.0">
		<Label styleClass="title-label" text="Sessions Report" />
		<HBox>
			<TableView fx:id="sessionTable" prefHeight="400.0"
				prefWidth="1050.0" styleClass="main-table">
				<columns>
					<TableColumn fx:id="colSessionId" minWidth="80.0"
						prefWidth="100.0" text="Session ID" />
					<TableColumn fx:id="colSubscriberId" minWidth="100.0"
						prefWidth="120.0" text="Subscriber ID" />
					<TableColumn fx:id="colSpotId" minWidth="80.0"
						prefWidth="100.0" text="Spot ID" />
					<TableColumn fx:id="colParkingCode" minWidth="100.0"
						prefWidth="120.0" text="Parking Code" />
					<TableColumn fx:id="colInTime" minWidth="150.0"
						prefWidth="180.0" text="In Time" />
					<TableColumn fx:id="colOutTime" minWidth="150.0"
						prefWidth="180.0" text="Out Time" />
					<TableColumn fx:id="colExtended" minWidth="70.0"
						prefWidth="90.0" text="Extended" />
					<TableColumn fx:id="colLate" minWidth="70.0"
						prefWidth="80.0" text="Late" />
					<TableColumn fx:id="colActive" minWidth="70.0"
						prefWidth="80.0" text="Active" />
				</columns>
			</TableView>
			<PieChart fx:id="parkingSpotChart" title="Parking Spots" />
		</HBox>
		<GridPane alignment="CENTER" hgap="10" vgap="10">
			<columnConstraints>
				<ColumnConstraints hgrow="ALWAYS" maxWidth="200.0"
					minWidth="10.0" prefWidth="150.0" />
				<ColumnConstraints hgrow="ALWAYS" maxWidth="500.0"
					minWidth="200.0" prefWidth="300.0" />
			</columnConstraints>
			<rowConstraints>
				<RowConstraints minHeight="10.0" vgrow="SOMETIMES" />
			</rowConstraints>
			<children>
				<!-- Label with left alignment -->
				<Label text="Choose Date:" GridPane.columnIndex="0"
					GridPane.rowIndex="0" alignment="CENTER_LEFT" contentDisplay="LEFT"
					styleClass="form-label" />

				<!-- DatePicker with proper column placement -->
				<DatePicker fx:id="datePick" prefHeight="73.0"
					prefWidth="590.0" GridPane.columnIndex="1" GridPane.rowIndex="0" />
			</children>
		</GridPane>
		<!-- Line Chart -->
		<LineChart fx:id="activeSessionLineChart" prefHeight="300.0"
			prefWidth="1050.0" title="Active Sessions per Hour">
			<xAxis>
				<NumberAxis label="Hour of Day" lowerBound="0"
					tickUnit="1" upperBound="23" fx:id="xAxis" />
			</xAxis>
			<yAxis>
				<NumberAxis fx:id="yAxis" label="Session Count" />
			</yAxis>
		</LineChart>


		<!-- CSV Export -->
		<HBox alignment="CENTER" spacing="15.0">
			<Button fx:id="exportCsvButton" styleClass="button-blue"
				text="Create report" />
			<Button fx:id="showPDF" styleClass="button-blue"
				text="Show PDF" />
		</HBox>
		<HBox alignment="CENTER" spacing="15.0">
			<Button fx:id="refreshButton" styleClass="button-blue"
				text="ðŸ”„Refresh" />
			<!-- Back Button -->
			<Button fx:id="backButton" onAction="#handleBackButton"
				styleClass="button-red" text="Back" />
		</HBox>
	</VBox>
</AnchorPane>
